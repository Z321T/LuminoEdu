基于你提供的项目代码结构和当前打开的 `server/tests/test_login.py` 文件，我来完善测试登录接口的测试案例。你目前使用的是 `unittest` 框架，我会基于这个框架设计测试用例。

```python
import unittest
import asyncio
from fastapi.testclient import TestClient
from fastapi import status

from app.main import app
from app.models import Student, Teacher, Admin
from app.models.user_common import UserRole
from tortoise import Tortoise

class TestLogin(unittest.TestCase):
    client = TestClient(app)

    @classmethod
    def setUpClass(cls):
        """设置测试环境，初始化数据库连接和测试数据"""
        # 设置事件循环
        cls.loop = asyncio.get_event_loop()
        
        # 初始化数据库
        cls.loop.run_until_complete(
            Tortoise.init(
                db_url="mysql://root:root@localhost:3306/luminoedu_test",
                modules={"models": ["app.models"]}
            )
        )
        cls.loop.run_until_complete(Tortoise.generate_schemas())
        
        # 创建测试用户
        cls.loop.run_until_complete(cls.create_test_users())

    @classmethod
    def tearDownClass(cls):
        """清理资源"""
        # 清理测试数据
        cls.loop.run_until_complete(cls.clean_test_users())
        
        # 关闭数据库连接
        cls.loop.run_until_complete(Tortoise.close_connections())

    @classmethod
    async def create_test_users(cls):
        """创建测试用户"""
        # 学生用户
        student = await Student.filter(username="test_student").first()
        if not student:
            student = Student(username="test_student", role=UserRole.STUDENT)
            student.set_password("password123")
            await student.save()
            
        # 教师用户
        teacher = await Teacher.filter(username="test_teacher").first()
        if not teacher:
            teacher = Teacher(username="test_teacher", role=UserRole.TEACHER)
            teacher.set_password("password123")
            await teacher.save()
            
        # 管理员用户
        admin = await Admin.filter(username="test_admin").first()
        if not admin:
            admin = Admin(username="test_admin", role=UserRole.ADMIN)
            admin.set_password("password123")
            await admin.save()

    @classmethod
    async def clean_test_users(cls):
        """清理测试用户"""
        await Student.filter(username="test_student").delete()
        await Teacher.filter(username="test_teacher").delete()
        await Admin.filter(username="test_admin").delete()

    def test_login_student_success(self):
        """测试学生成功登录"""
        response = self.client.post(
            "/login",
            json={"username": "test_student", "password": "password123", "role": UserRole.STUDENT}
        )
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        data = response.json()
        self.assertIn("access_token", data)
        self.assertEqual(data["token_type"], "bearer")
        self.assertIsNotNone(data["user_id"])
        self.assertEqual(data["role"], UserRole.STUDENT)
        self.assertEqual(data["username"], "test_student")

    def test_login_teacher_success(self):
        """测试教师成功登录"""
        response = self.client.post(
            "/login",
            json={"username": "test_teacher", "password": "password123", "role": UserRole.TEACHER}
        )
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        data = response.json()
        self.assertIn("access_token", data)
        self.assertEqual(data["token_type"], "bearer")
        self.assertEqual(data["role"], UserRole.TEACHER)
        self.assertEqual(data["username"], "test_teacher")

    def test_login_admin_success(self):
        """测试管理员成功登录"""
        response = self.client.post(
            "/login",
            json={"username": "test_admin", "password": "password123", "role": UserRole.ADMIN}
        )
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        data = response.json()
        self.assertIn("access_token", data)
        self.assertEqual(data["token_type"], "bearer")
        self.assertEqual(data["role"], UserRole.ADMIN)

    def test_login_invalid_password(self):
        """测试密码错误"""
        response = self.client.post(
            "/login",
            json={"username": "test_student", "password": "wrong_password", "role": UserRole.STUDENT}
        )
        
        self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)

    def test_login_invalid_username(self):
        """测试用户名不存在"""
        response = self.client.post(
            "/login",
            json={"username": "nonexistent_user", "password": "password123", "role": UserRole.STUDENT}
        )
        
        self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)

    def test_login_role_mismatch(self):
        """测试角色不匹配"""
        response = self.client.post(
            "/login",
            json={"username": "test_student", "password": "password123", "role": UserRole.TEACHER}
        )
        
        self.assertEqual(response.status_code, status.HTTP_403_FORBIDDEN)

    def test_get_current_user(self):
        """测试获取当前用户信息"""
        # 先登录获取token
        login_response = self.client.post(
            "/login",
            json={"username": "test_student", "password": "password123", "role": UserRole.STUDENT}
        )
        
        token = login_response.json()["access_token"]
        
        # 使用token请求用户信息
        response = self.client.get(
            "/me",
            headers={"Authorization": f"Bearer {token}"}
        )
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        data = response.json()
        self.assertEqual(data["username"], "test_student")
        self.assertEqual(data["role"], UserRole.STUDENT)


if __name__ == '__main__':
    unittest.main()
```

### 说明

这个测试文件实现了以下功能：

1. 使用 `unittest` 框架编写测试用例，与你现有的测试文件风格一致
2. 在 `setUpClass` 中初始化数据库连接和测试数据
3. 在 `tearDownClass` 中清理测试数据和数据库连接
4. 创建了多个测试用例：
   - 测试三种角色（学生、教师、管理员）的成功登录情况
   - 测试密码错误的情况
   - 测试用户名不存在的情况
   - 测试角色不匹配的情况
   - 测试使用令牌获取用户信息的接口

当用户成功登录时，将验证响应中是否包含预期的字段：`access_token`、`token_type`、`user_id`、`role` 和 `username`。

### 注意事项

1. 确保安装了必要的依赖：
   ```
   pip install fastapi-testclient pytest 
   ```

2. 测试数据库配置需要根据你的实际环境调整

3. 运行测试：
   ```
   python -m unittest server/tests/test_login.py
   ```

4. 这个测试依赖于你的应用已经正确配置和初始化